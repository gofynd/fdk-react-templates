!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("card-validator"),require("fdk-core/utils"),require("react"),require("react-router-dom")):"function"==typeof define&&define.amd?define("firestone",["card-validator","fdk-core/utils","react","react-router-dom"],t):"object"==typeof exports?exports.firestone=t(require("card-validator"),require("fdk-core/utils"),require("react"),require("react-router-dom")):e.firestone=t(e["card-validator"],e["fdk-core/utils"],e.react,e["react-router-dom"])}("undefined"!=typeof self?self:this,((e,t,a,r)=>(()=>{"use strict";var n={4814:(e,t,a)=>{a.d(t,{A:()=>s});var r,n=a(9155);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_extends.apply(null,arguments)}const s=function SvgAddress(e){return n.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),r||(r=n.createElement("path",{fill:"#4D4D4E",d:"m10.001 5.16 4.167 3.75v6.508h-1.667v-5h-5v5H5.835V8.91zm0-2.242-8.333 7.5h2.5v6.667h5v-5h1.667v5h5v-6.667h2.5z"})))}},7962:(e,t,a)=>{a.d(t,{A:()=>s});var r,n=a(9155);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_extends.apply(null,arguments)}const s=function SvgCall(e){return n.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),r||(r=n.createElement("path",{fill:"#4D4D4E",d:"M5.45 4.167c.05.741.175 1.466.375 2.158l-1 1c-.342-1-.558-2.058-.633-3.158zm8.217 10.016c.708.2 1.433.325 2.166.375V15.8a12.9 12.9 0 0 1-3.166-.625zM6.25 2.5H3.333a.836.836 0 0 0-.833.833C2.5 11.158 8.842 17.5 16.667 17.5a.836.836 0 0 0 .833-.833v-2.909a.836.836 0 0 0-.833-.833 9.5 9.5 0 0 1-2.975-.475.7.7 0 0 0-.259-.042.85.85 0 0 0-.591.242l-1.834 1.833a12.62 12.62 0 0 1-5.491-5.491L7.35 7.158a.84.84 0 0 0 .208-.85 9.5 9.5 0 0 1-.475-2.975.836.836 0 0 0-.833-.833"})))}},7010:(e,t,a)=>{a.d(t,{A:()=>s});var r,n=a(9155);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_extends.apply(null,arguments)}const s=function SvgEmail(e){return n.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),r||(r=n.createElement("path",{fill:"#4D4D4E",d:"M18.335 4.999c0-.917-.75-1.667-1.667-1.667H3.335c-.917 0-1.667.75-1.667 1.667v10c0 .916.75 1.666 1.667 1.666h13.333c.917 0 1.667-.75 1.667-1.666zm-1.667 0-6.667 4.158-6.666-4.158zm0 10H3.335V6.665L10 10.832l6.667-4.167z"})))}},9825:(e,t,a)=>{a.d(t,{A:()=>o});var r,n,s=a(9155);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_extends.apply(null,arguments)}const o=function SvgOrders(e){return s.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none"},e),s.createElement("mask",{id:"orders_svg__a",width:20,height:20,x:0,y:0,maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},r||(r=s.createElement("path",{fill:"#D9D9D9",d:"M0 0h20v20H0z"}))),n||(n=s.createElement("g",{mask:"url(#orders_svg__a)"},s.createElement("path",{fill:"#4D4D4E",d:"M4.418 17.918q-.625 0-1.063-.437a1.45 1.45 0 0 1-.437-1.063v-9.5q0-.625.437-1.063a1.45 1.45 0 0 1 1.063-.437h1.833q0-1.562 1.094-2.657Q8.44 1.668 10 1.668q1.563 0 2.657 1.093 1.093 1.094 1.093 2.657h1.834q.624 0 1.062.437.438.438.438 1.063v9.5q0 .625-.438 1.063a1.45 1.45 0 0 1-1.062.437zm0-1.25h11.167q.082 0 .166-.083.084-.084.084-.167v-9.5q0-.083-.084-.167-.082-.083-.166-.083H4.418q-.083 0-.167.083-.083.084-.083.167v9.5q0 .084.083.167t.167.083m5.583-5.417q1.563 0 2.657-1.093 1.093-1.094 1.093-2.657h-1.25q0 1.042-.729 1.771a2.4 2.4 0 0 1-1.77.73 2.4 2.4 0 0 1-1.772-.73 2.4 2.4 0 0 1-.729-1.77h-1.25q0 1.562 1.094 2.656Q8.44 11.251 10 11.251m-2.5-5.833h5q0-1.042-.729-1.77a2.4 2.4 0 0 0-1.77-.73 2.4 2.4 0 0 0-1.772.73 2.4 2.4 0 0 0-.729 1.77"}))))}},266:(e,t,a)=>{var r=a(9825),n=a(7962),s=a(7010),o=a(4814);r.A,n.A,s.A,o.A},6249:(e,t,a)=>{a.d(t,{useViewport:()=>r.useViewport});a(8618);var r=a(1566);a(4070),a(8532)},8532:(e,t,a)=>{a(9155),a(4429)},8618:(e,t,a)=>{a(9155),a(4429)},4070:(e,t,a)=>{a(9155)},1566:(e,t,a)=>{a.d(t,{useViewport:()=>useViewport});var r=a(9155);const useViewport=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const[a,n]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const handleResize=()=>{if("undefined"!=typeof window){const a=window?.innerWidth;n(a>=e&&a<=t)}};return handleResize(),window?.addEventListener("resize",handleResize),()=>{window?.removeEventListener("resize",handleResize)}}),[e,t]),a}},4429:(e,t,a)=>{a(266)},1029:t=>{t.exports=e},447:e=>{e.exports=t},9155:e=>{e.exports=a},4442:e=>{e.exports=r}},s={};function __webpack_require__(e){var t=s[e];if(void 0!==t)return t.exports;var a=s[e]={exports:{}};return n[e](a,a.exports,__webpack_require__),a.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{__webpack_require__.r(o),__webpack_require__.d(o,{CREDIT_CARD_MASK:()=>d,useCheckoutPayment:()=>useCheckoutPayment});var e=__webpack_require__(9155),t=__webpack_require__(4442),a=__webpack_require__(1029),r=__webpack_require__.n(a),n=__webpack_require__(6249),s=__webpack_require__(447);const d=[{mask:"0000 000000 00000",cardtype:"american-express"},{mask:"0000 0000 0000 0000",cardtype:"discover"},{mask:"0000 000000 0000",cardtype:"diners-club"},{mask:"0000 0000 0000 0000",cardtype:"mastercard"},{mask:"0000 000000 00000",cardtype:"jcb15"},{mask:"0000 0000 0000 0000",cardtype:"jcb"},{mask:"0000 0000 0000 0000",cardtype:"maestro"},{mask:"0000 0000 0000 0000",cardtype:"visa"},{mask:"0000 0000 0000 0000",cardtype:"unionpay"},{mask:"0000 0000 0000 0000",cardtype:"rupay"},{mask:"0000 0000 0000 0000",cardtype:"Unknown"}];function useCheckoutPayment(a){let{payment:o,handleShowFailedMessage:c,breakUpValues:i,setCancelQrPayment:l,isCouponApplied:u,juspayErrorMessage:p,setMopPayload:m,styles:_}=a;const g=(0,s.useFPI)(),{language:y}=(0,s.useGlobalStore)(g.getters.i18N_DETAILS),h=y?.locale,{t:f}=(0,s.useGlobalTranslation)("translation"),{selectedTab:v,selectedTabData:C,proceedToPay:S,getTotalValue:w,PaymentOptionsList:b,setSelectedTab:k,paymentOption:P,handleIsQrCodeLoading:D,getUPIIntentApps:E,cardDetails:I,checkAndUpdatePaymentStatus:O,cancelPayment:A,otherOptions:M,setUPIError:R,validateCoupon:q,selectPaymentMode:x,enableLinkPaymentOption:N}=o,U=/Chrome/.test(navigator.userAgent)||/Safari/.test(navigator.userAgent)||/Instagram/.test(navigator.userAgent),B=(0,n.useViewport)(0,768);let T=b?b():[],L=T?.filter((e=>"COD"===e.name))[0];T=T?.filter((e=>"COD"!==e.name));const $=(0,e.useMemo)((()=>M?M():[]),[P]),j=!!P?.payment_option?.find((e=>"UPI"===e?.name)),V=!!P?.payment_option?.find((e=>"QR"===e?.name));j&&V&&(T=T?.filter((e=>"QR"!==e?.name))),!j||V||B||(T=T?.filter((e=>"UPI"!==e?.name))),V&&!j&&B&&(T=T?.filter((e=>"QR"!==e?.name)));const[Q,z]=(0,e.useState)(!1),[H,W]=(0,e.useState)(""),[G,F]=(0,e.useState)(""),[J,K]=(0,e.useState)(!1),[Y,X]=(0,e.useState)(!1),[Z,ee]=(0,e.useState)(!1),[te,ae]=(0,e.useState)(!1),[re,ne]=(0,e.useState)(!1),[se,oe]=(0,e.useState)(!0),[de,ce]=(0,e.useState)(null),[ie]=(0,t.useSearchParams)(),le=((0,s.useNavigate)(),ie.get("id")),ue=ie.get("address_id"),pe=ie.get("billing_address_id"),me=(0,e.useRef)(null),_e=(0,e.useRef)(null),[ge,ye]=(0,e.useState)(null),[he,fe]=(0,e.useState)({}),[ve,Ce]=(0,e.useState)(""),[Se,we]=(0,e.useState)(""),[be,ke]=(0,e.useState)({}),[Pe,De]=(0,e.useState)({}),[Ee,Ie]=(0,e.useState)({}),[Oe,Ae]=(0,e.useState)({}),[Me,Re]=(0,e.useState)(!1),[qe,xe]=(0,e.useState)({selectedCard:ge,isCardSecure:se,selectedCardless:Ee,selectedPayLater:Pe,selectedWallet:he,selectedNB:be,vpa:ve,selectedOtherPayment:Oe,selectedUpiIntentApp:Se}),[Ne,Ue]=(0,e.useState)(null),[Be,Te]=(0,e.useState)(!1),[Le,$e]=(0,e.useState)(!1),[je,Ve]=(0,e.useState)({}),[Qe,ze]=(0,e.useState)(0),[He,We]=(0,e.useState)(!1),[Ge,Fe]=(0,e.useState)(!1),[Je,Ke]=(0,e.useState)(""),[Ye,Xe]=(0,e.useState)(!1),[Ze,et]=(0,e.useState)(""),[tt,at]=(0,e.useState)([]),[rt,nt]=(0,e.useState)(!1),[st,ot]=(0,e.useState)(null),[dt,ct]=(0,e.useState)(null),[it,lt]=(0,e.useState)({}),[ut,pt]=(0,e.useState)(!0),mt=(0,e.useRef)(null),[_t,gt]=(0,e.useState)(!1),[yt,ht]=(0,e.useState)(""),[ft,vt]=(0,e.useState)(""),[Ct,St]=(0,e.useState)({}),[wt,bt]=(0,e.useState)(""),[kt,Pt]=(0,e.useState)(""),[Dt,Et]=(0,e.useState)(""),[It,Ot]=(0,e.useState)(""),At=(0,e.useRef)(null),[Mt,Rt]=(0,e.useState)([]),[qt,xt]=(0,e.useState)(""),[Nt,Ut]=(0,e.useState)(!1),[Bt,Tt]=(0,e.useState)({}),[Lt,$t]=(0,e.useState)(!1),[jt,Vt]=(0,e.useState)(!1),[Qt,zt]=(0,e.useState)(!1),[Ht,Wt]=(0,e.useState)(null),[Gt,Ft]=(0,e.useState)(null),[Jt,Kt]=(0,e.useState)(""),[Yt,Xt]=(0,e.useState)(!1),Zt=(0,s.useGlobalStore)(g?.getters?.SHIPMENTS),ea=(0,s.useGlobalStore)(g?.getters?.CUSTOM_VALUE)??{},ta=(0,e.useRef)(null),aa=(0,e.useRef)(null);(0,e.useEffect)((()=>{N&&v&&Wt(v)}),[N,v]);(0,e.useEffect)((()=>{Ct?.card_brand&&selectMop("CARD","CARD","newCARD")}),[Ct?.card_brand]),(0,e.useEffect)((()=>{u&&selectMop("CARD","CARD","CARD")}),[Yt,u]);const ra={gpay:{displayName:f("resource.checkout.google_pay")},phonepe:{displayName:f("resource.checkout.phonepe_upi")},paytm:{displayName:f("resource.checkout.paytm_upi")},any:{displayName:f("resource.checkout.more_apps")}},na=(0,e.useRef)(v),stopPolling=()=>{mt.current&&(clearInterval(mt.current),mt.current=null)},initializeOrResetQrPayment=()=>{nt(!1),D(!1),stopPolling()},cancelQrPayment=async()=>{if(initializeOrResetQrPayment(),it.merchant_order_id)try{const e=await A({order_id:it.merchant_order_id,request_type:"cancel"}),{data:t,success:a}=e.data.resendOrCancelPayment;a&&"true"==t.status&&lt({})}catch(e){console.log("Payment cancellation failed")}},startPolling=e=>{ze(600),mt.current=setInterval((()=>{pollPaymentStatus(e)}),2e3)};(0,e.useEffect)((()=>()=>stopPolling()),[]),(0,e.useEffect)((()=>{cancelQrPayment(),l?.({handleQr:cancelQrPayment});const e=P?.payment_option?.find?.((e=>e.name===v))?.stored_payment_details;"CARD"===v&&Rt(e),"UPI"!==v||tt?.length||E?.()?.then?.((e=>{const t=Array.isArray(e)?e.map((e=>"object"==typeof e&&e?.code?e.code:e)):e;at(t)})),"COD"!==na.current||"COD"===v||N||x({id:le,address_id:ue,payment_mode:"",aggregator_name:""}).then((()=>console.log("mop selection"))),na.current=v}),[v]),(0,e.useEffect)((()=>{let e;return Be&&null!==Qe&&Qe>0?e=setInterval((()=>{ze((t=>t<=1?(clearInterval(e),0):t-1))}),1e3):Be&&0===Qe&&cancelUPIPayment(),()=>{e&&clearInterval(e)}}),[Be,Qe]);const paymentModeDetails=(e,t)=>{const a=P?.payment_option?.find((t=>t?.name===e));let r;return r="CARD"===e?a?.list?.filter((e=>e?.card_id===t))[0]:a?.list?.filter((e=>e?.code===t))[0],{mopData:a,subMopData:r}},selectMop=async(e,t,a)=>{if(!t)return;bt(e),Pt(t),Et(a);const{mopData:r,subMopData:n}=paymentModeDetails(t,a);let s;s="CARD"===e?"newCard"===a?{id:le,addressId:ue,paymentMode:t,aggregatorName:r?.aggregator_name,cardId:Ct?.id,iin:Ct?.card_object,paymentIdentifier:Ct?.bank_code,merchant_code:Ct?.bank_code,type:Ct?.type||"debit",network:Ct?.card_brand||n?.card_brand}:{id:le,addressId:ue,paymentMode:t,aggregatorName:n?.aggregator_name||r?.aggregator_name||"Razorpay",cardId:Ct?.id,iin:Ct?.card_object,paymentIdentifier:Ct?.bank_code,merchant_code:Ct?.bank_code,type:Ct?.type||"debit",network:Ct?.card_brand||n?.card_brand}:{id:le,addressId:ue,paymentMode:t,aggregatorName:n?.aggregator_name,paymentIdentifier:n?.code??"",merchantCode:n?.merchant_code},N||m(v===e?s:null);let o,d=!0;if(u&&v===e){const{code:e,title:t,display_message_en:a,valid:r}=!N&&await(async e=>{if(0===w())return!0;const t=await q(e),{coupon_validity:a}=t.data.validateCoupon||{};return a})(s);if(d=!e||e&&r,!d)return Ve({title:t,message:a,valid:r}),void $e(!0)}o="CARD"===t?"newCARD"===a?{id:le,address_id:ue,payment_mode:t,aggregator_name:r?.aggregator_name}:{id:le,address_id:ue,payment_mode:t,aggregator_name:n?.aggregator_name,payment_identifier:n?.card_id}:{id:le,address_id:ue,payment_mode:t,aggregator_name:n?.aggregator_name,payment_identifier:n?.code??"",merchant_code:n?.merchant_code},"COD"===e?(x(o).then((()=>console.log("Payment mode selected"))),k(e),Vt(!0)):"CARD"===e?"newCARD"!==a&&ye(n):"CARDLESS_EMI"===e?Ie(n):"UPI"===e?"QR"===t?await showQrCode():"UPI"===t&&await handleProceedToPayClick():"WL"===e?fe(n):"NB"===e?ke(n):"PL"===e?De(n):"Other"===e&&Ae(n)};async function showQrCode(){try{const e=await S("QR"),{data:t,success:a}=e?.payload?.data?.checkoutCart||{};if(a&&t.base64_encoded_qr){nt(!0),ot(t.base64_encoded_qr),ct(t.timeout);const e={aggregator:t?.aggregator,method:t?.method,merchant_order_id:t?.merchant_order_id,virtual_id:t?.virtual_id,amount:t?.amount,contact:t?.contact,currency:t?.currency,customer_id:t?.customer_id,email:t?.email,order_id:t?.order_id,merchant_transaction_id:"",status:""};lt({...e,callback_url:t?.callback_url}),startPolling(e)}(e?.code||e?.message)&&c({failed:!0,paymentErrHeading:f("resource.checkout.please_try_again_later"),paymentErrMsg:e.message})}catch(e){c({failed:!0,paymentErrHeading:f("resource.checkout.please_try_again_later"),paymentErrMsg:f("resource.checkout.qr_code_generation_failed")})}D(!1)}(0,e.useEffect)((()=>{ea.isCouponApplied||("Other"!==v||C||0!==T.length||selectMop("Other",$[0]?.name,$[0]?.list?.[0]?.code??""),"CARD"!==C?.name&&"UPI"!==C?.name&&T[0]?.name===C?.name&&selectMop(C?.name,C?.name,C?.list[0]?.code??""))}),[C?.list?.[0]?.code,$,v]);const pollPaymentStatus=async e=>{try{const t=await O(e),a=t?.data?.checkAndUpdatePaymentStatus?.status;if("success"===a){stopPolling(),Te(!1);const t={success:"true",order_id:e.merchant_order_id,delivery_address_id:ue,billing_address_id:pe},a=new URLSearchParams;for(const e in t)a.append(e,t[e]);const r=`${window.location.origin}${h&&"en"!==h?`/${h}`:""}/cart/order-status/?${a.toString()}`;window.location.href=r}else if("failed"===a)Te(!1),initializeOrResetQrPayment(),c({failed:!0});else if(t?.errors?.length>0){const{message:e}=t.errors[0];Te(!1),initializeOrResetQrPayment(),c({failed:!0,paymentErrMsg:e})}}catch(e){c({failed:!0})}};(0,e.useEffect)((()=>{xe({selectedCard:ge,isCardSecure:se,selectedCardless:Ee,selectedPayLater:Pe,selectedWallet:he,selectedNB:be,vpa:Me||ve,selectedOtherPayment:Oe,selectedUpiIntentApp:Se})}),[ge,Ee,Pe,he,be,ve,se,Oe,Se,Me]);const isJuspayEnabled=()=>P?.payment_option?.find((e=>"juspay"===e.aggregator_name?.toLowerCase()&&"CARD"===e.name)),handlePayment=async()=>{try{const e=await(async()=>{const e={...qe};return await S("newCARD",e)})();Ue(e)}catch(e){Ue({error:e})}};(0,e.useEffect)((()=>{if(p&&!Ne&&P?.payment_option?.find((e=>"juspay"===e.aggregator_name?.toLowerCase()&&"CARD"===e.name))){const e=`error_${p}_${!!Ne}`;ta.current!==e&&(ta.current=e,handlePayment())}else(async()=>{if(isJuspayEnabled()&&!Ne){const e=`${!!Ne}_${!!p}_${P?.payment_option?.length}`;if(ta.current===e)return;ta.current=e;try{await handlePayment()}catch(e){console.error("Juspay initialization error:",e)}}})()}),[Ne,p,P]);const isCardValid=()=>Qt&&ft&&aa.current?.value&&G&&!Y&&!re&&!Z&&!te,handleProceedToPayClick=async()=>{try{let e=await S("UPI",{...qe,selectedUpiIntentApp:At.current||Se});const{order_id:t}=e?.payload?.data?.checkoutCart||{};if(Ft(t),e?.isUPIError)return void R(!0);if(e?.code||e?.message)return void c({failed:!0,paymentErrMsg:e.message});if(ve||Me){const{data:t,success:a,order_id:r}=e?.payload?.data?.checkoutCart||{};if(a){const a={aggregator:e.aggregator_name,method:t?.method,merchant_order_id:r,amount:t?.amount,contact:t?.contact,currency:t?.currency,customer_id:t?.customer_id,email:t?.email,order_id:t?.order_id,merchant_transaction_id:"",status:""};Te(!0),startPolling(a)}}}catch(e){console.log(e)}};function cancelUPIPayment(){Te(!1),stopPolling()}(0,e.useEffect)((()=>{const e=P?.payment_option?.find((e=>"QR"===e.name));e&&gt(!0),0===w?.()?k("COD"):N||(T?.length>0?(k(T[0].name),Wt(T[0].name)):$?.length>0?(k("Other"),Wt("Other")):L?.name&&selectMop(L?.name,L?.name,L?.name))}),[P]);const sa=i?.filter((e=>"cod_charge"===e.key))[0]?.value??0;return{t:f,isTablet:B,isChromeOrSafari:U,paymentOptions:T,otherPaymentOptions:$,codOption:L,showCouponValidityModal:Le,setShowCouponValidityModal:$e,couponValidity:je,addNewCard:Q,getCardBorder:e=>ge?.card_id===e?.card_id?`${_.selectedBorder}`:`${_.nonSelectedBorder}`,savedCards:Mt,cardExpiryDate:H,setCardExpiryDate:W,cvvNumber:G,setCvvNumber:F,showError:J,cardNumberError:Y,cardExpiryError:Z,cardCVVError:te,cardNameError:re,isCardSecure:se,openGuidelinesModal:He,setOpenGuidelinesModal:We,CREDIT_CARD_MASK:d,cardNumber:yt,nameOnCard:ft,setNameOnCard:vt,cardDetailsData:Ct,setLastValidatedBin:Kt,nameRef:me,cardNumberRef:_e,selectedUpiRef:At,selectedCard:ge,selectedWallet:he,selectedNB:be,selectedPayLater:Pe,selectedCardless:Ee,selectedOtherPayment:Oe,selectedPaymentPayload:qe,setSelectedPaymentPayload:xe,setSelectedOtherPayment:Ae,setSavedUPISelect:Re,setvpa:Ce,upiApps:tt,selectedUpiIntentApp:Se,setSelectedUpiIntentApp:we,showUPIModal:Be,timeRemaining:Qe,isQrMopPresent:_t,isQrCodeVisible:rt,qrCodeImage:st,countdown:dt,setTab:bt,mop:kt,subMop:Dt,activeMop:Ht,toggleMop:e=>{Wt((t=>t===e?null:e))},isCodModalOpen:jt,setIsCodModalOpen:Vt,disbaleCheckout:Zt,codCharges:sa,openMoreWalletModal:Ge,setOpenMoreWalletModal:Fe,walletSearchText:Je,setWalletSearchText:Ke,openMoreNbModal:Ye,setOpenMoreNbModal:Xe,nbSearchText:Ze,setNbSearchText:et,cvvValues:Bt,isCvvInfo:Lt,isCvvNotNeededModal:Nt,setIsCvvInfo:$t,setIsCvvNotNeededModal:Ut,handleCvvChange:(e,t)=>{Tt((a=>({...a,[e]:t})))},handleCvvInfo:e=>$t(e),selectMop,removeCoupon:async()=>{const{mopData:e,subMopData:t}=paymentModeDetails(kt,Dt);let a;a="CARD"===kt?"newCARD"===Dt?{id:le,address_id:ue,payment_mode:kt,aggregator_name:e?.aggregator_name}:{id:le,address_id:ue,payment_mode:kt,aggregator_name:t?.aggregator_name,payment_identifier:t?.card_id}:{id:le,address_id:ue,payment_mode:kt,aggregator_name:t?.aggregator_name,payment_identifier:t?.code??"",merchant_code:t?.merchant_code},x(a).then((()=>{console.log("Payment mode selected")})),"COD"===wt?(k(wt),Vt(!0)):"CARD"===wt?"newCARD"!==Dt&&ye(t):"CARDLESS_EMI"===wt?Ie(t):"UPI"===wt?"QR"===kt?await showQrCode():"UPI"===kt&&await handleProceedToPayClick():"Other"===wt?Ae(t):"WL"===wt?fe(t):"NB"===wt?ke(t):"PL"===wt&&De(t)},unsetSelectedSubMop:()=>{Ae({}),ke(""),fe(""),Ie(""),De(""),we(""),ye(""),Re(""),cancelQrPayment(),Et(""),Pt(""),X(""),ht("")},acceptOrder:()=>{Zt?.message&&c({failed:!0,paymentErrHeading:f("resource.checkout.please_try_again_later"),paymentErrMsg:Zt?.message})},cancelQrPayment,cancelUpiAppPayment:async()=>{try{stopPolling();const e=await A({order_id:Gt,request_type:"cancel"}),{data:t,success:a}=e?.data?.resendOrCancelPayment;a&&"true"==t.status&&console.log("Payment cancellation successful")}catch(e){console.log("Payment cancellation failed")}},cancelUPIPayment,addNewCardShow:()=>z(!0),hideNewCard:()=>z(!1),handleNewCardNumberChange:e=>{const t=r().number(e);if(_e.current){const e=d.find((e=>e.cardtype===(t?.card?.type??"unknown")))?.mask??d[d.length-1].mask;_e?.current?.maskRef?.masked?.updateOptions({mask:e})}},handleNewCardExpiryChange:(e,t)=>{ee(""),W(e),aa.current=t},keypressCvv:e=>!!/^[0-9]+$/.test(e.key)||(e.preventDefault(),!1),handleNewCardSaveState:e=>oe(e?.target.checked),handleCardNumberInput:async e=>{X("");let t=e.target.value;if(t=t.replace(/\s+/g,""),ht(t),6===t.length){if(t!==Jt){Kt(t);const e=await I(t),{data:a}=e.data.payment.card_details;St(a)}}else t.length<6&&(St({}),Kt(""))},handleCardNumberPaste:async e=>{X("");let t=e.clipboardData.getData("Text");const a=t.slice(0,6);if(ht(t),t=t.replace(/[^0-9]/g,""),t.length>=6){if(a!==Jt){Kt(a);const e=await I(a),{data:t}=e.data.payment.card_details;St(t)}}else St({}),Kt("")},handleNameOnCardInput:e=>{ne(""),vt(e.target.value)},validateCardNumber:async e=>{try{const t=e.target.value.replace(/[^0-9]/g,"");if(Qt||X(f("resource.checkout.invalid_card_number")),t.length>=6){const e=t.slice(0,6);if(e!==Jt){Kt(e);const t=await I(e),{data:a}=t.data.payment.card_details;a||yt?(St(a),a?.is_card_valid?Ct.is_enabled&&X(a?.is_enabled?"":f("resource.checkout.this_card_network_is_not_supported")):X(f("resource.checkout.invalid_card_number"))):X(f("resource.common.field_required"))}}else St({}),Kt(""),yt||X(f("resource.common.field_required"))}catch(e){console.log(e,"cardValidation error")}},validateNameOnCard:()=>{ft.trim()||ne(f("resource.common.field_required"))},validateCardExpiryDate:()=>{const e=aa.current;if(e?.masked?.isComplete){var t=new Date,a=t.getFullYear(),r=t.getMonth()+1,n=parseInt(e?.value.split("/")[1],10)+2e3,s=parseInt(e?.value.split("/")[0],10);(n<a||n===a&&s<r)&&ee(f("resource.checkout.expiry_date_passed"))}else ee(f("resource.checkout.enter_expiry_date"))},validateCvv:()=>{G?G.toString().length!==Ct.cvv_length&&ae(f("resource.checkout.invalid_cvv")):ae(f("resource.checkout.enter_cvv"))},handleCvvNumberInput:e=>{ae(""),F(e.target.value.replace(/[^0-9]/g,""))},setCardValidity:async e=>{let{isValid:t,card_number:a}=e;X(""),ht(a);const r=a.replace(/[^0-9]/g,"");if(zt(t),6===r.length){if(r!==Jt){Kt(r);const e=await I(r),{data:t}=e.data.payment.card_details;St(t)}}else r.length<6&&(St({}),Kt(""))},resetCardValidationErrors:()=>{X(""),ne(""),ee(""),ae("")},getTrimmedCardNumber:e=>e?.substring(e.length-4),isCardValid,payUsingCard:async()=>{if(isCardValid()){const e={cvv:G,card_number:yt.replace(/[^0-9]/g,""),name:ft,exp_month:aa.current?.value?.split("/")?.[0],exp_year:aa.current?.value?.split("/")?.[1]},t={...qe,selectedCardData:e},a=await S("newCARD",t);a?.code&&c({failed:!0,paymentErrMsg:a.message})}else c({failed:!0,paymentErrHeading:f("resource.checkout.card_verification_failed")})},paymentResponse:Ne,isJuspayEnabled,setIsJuspayCouponApplied:Xt,getSvgNameForApp:e=>({google_pay:"gpay",gpay:"gpay",phonepe:"phonepe",paytm:"paytm"}[e]||e),upiAppData:ra,formatTime:e=>{const t=Math.floor(e/60),a=e%60;return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`},getWalletdBorder:function getWalletdBorder(e){return he?.code===e?.code?`${_.selectedBorder}`:`${_.nonSelectedBorder}`},getNBBorder:function getNBBorder(e){return e&&be?.code===e?.code?`${_.selectedBorder}`:`${_.nonSelectedBorder}`},getNormalisedList:e=>(e?.list??[]).reduce(((e,t)=>{let a={...t};return a.id=t?.code?t.aggregator_name+t.code:t?.aggregator_name??"",e.push(a),e}),[]),getPayLaterBorder:function getPayLaterBorder(e){return Pe?.code===e?.code?`${_.selectedBorder}`:`${_.nonSelectedBorder}`},getCardlessBorder:function getCardlessBorder(e){return Ee?.code===e?.code?`${_.selectedBorder}`:`${_.nonSelectedBorder}`},getOPBorder:function getOPBorder(e){return e&&Oe.code===e.code?`${_.selectedBorder}`:`${_.nonSelectedBorder}`},handleScrollToTop:e=>{const t=document.getElementById(`nav-title-${e}`);if(t){const e=400,a=t.getBoundingClientRect().top+window.scrollY-e;window.scrollTo({top:a,behavior:"smooth"})}}}}})(),o})()));
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("fdk-core/utils"),require("react"),require("react-hook-form"),require("react-router-dom")):"function"==typeof define&&define.amd?define("firestone",["fdk-core/utils","react","react-hook-form","react-router-dom"],t):"object"==typeof exports?exports.firestone=t(require("fdk-core/utils"),require("react"),require("react-hook-form"),require("react-router-dom")):e.firestone=t(e["fdk-core/utils"],e.react,e["react-hook-form"],e["react-router-dom"])}("undefined"!=typeof self?self:this,((e,t,n,r)=>(()=>{"use strict";var o={345:(e,t,n)=>{n.d(t,{o:()=>useAccounts});var r=n(9155),o=n(447),a=n(4442),i=n(6111),s=n(1948);const useAccounts=e=>{let{fpi:t}=e;const n=(0,a.useNavigate)(),l=(0,a.useLocation)(),[c,u]=(0,r.useState)(null),m=(0,o.useGlobalStore)(t.getters.USER_DATA),d=(0,o.useGlobalStore)(t.getters.PLATFORM_DATA),p=(0,o.useGlobalStore)(t.getters.LOGGED_IN),_=(0,r.useMemo)((()=>c?.is_signed_in?`Continue as ${c.profile.full_name}`:"Login with Facebook"),[c]),facebookLogin=async()=>{};return{userData:m,platformData:d,isLoggedIn:p,openLogin:function(){let{redirect:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams(l.search);e&&t.set("redirectUrl",encodeURIComponent(l.pathname+l.search)),n({pathname:"/auth/login",search:t.toString()})},openRegister:function(){let{redirect:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URLSearchParams(l.search);e&&t.set("redirectUrl",l.pathname),n({pathname:"/auth/register",search:t.toString()})},openForgotPassword:()=>{n({pathname:"/auth/forgot-password",search:l.search})},openHomePage:()=>{const e=new URLSearchParams(l.search).get("redirectUrl")||"";window.location.href=window.location.origin+decodeURIComponent(e)},updateProfile:e=>{const n=window.APP_DATA.applicationID,{registerToken:r,firstName:o,lastName:a,gender:l,email:c,phone:{countryCode:u,mobile:m}}=e,d=[["$platform",`${n}`],["$editProfileRequestInput",`${`{\n\t\t\tcountry_code: "${u}",\n    \tfirst_name: "${o}",\n\t\t\tlast_name: "${a}",\n\t\t\tgender: "${l}",\n\t\t\tregister_token: "${r}",\n\t\t\t${c?`email: "${c}",`:""}\n\t\t\t${m&&u?`mobile: {\n\t\t\t\tcountry_code: "${u}",\n\t\t\t\tphone: "${m}"\n\t\t\t}`:""}\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.ab,d),null)},signOut:()=>t.executeGraphQL((0,i.Ll)(s.T_),null).then((e=>{if(e?.errors)throw e?.errors?.[0];if(e?.user?.logout?.logout){const t=new URLSearchParams(l.search).get("redirectUrl")||"";return window.location.href=window.location.origin+decodeURIComponent(t),e}return Promise.reject()})),signIn:e=>{const{isRedirection:n,password:r,username:o}=e,a=[["$username",`${o}`],["$password",`${r}`]];return t.executeGraphQL((0,i.Ll)(s.oW,a),null).then((e=>{if(e?.errors)throw e?.errors?.[0];if(n){const e=new URLSearchParams(l.search).get("redirectUrl")||"";window.location.href=window.location.origin+decodeURIComponent(e)}return e}))},sendOtp:e=>{let{mobile:n,countryCode:r}=e;const o=[["$platform",`${window.APP_DATA.applicationID}`],["$sendOtpRequestInput",`${`{\n\t\t\tmobile: "${n}"\n\t\t\tcountry_code: "${r}",\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.xc,o),null)},resendOtp:e=>{let{mobile:n,countryCode:r,token:o,action:a}=e;const l=[["$platform",`${window.APP_DATA.applicationID}`],["$sendMobileOtpRequestInput",`${`{\n\t\t\tmobile: "${n}",\n\t\t\tcountry_code: "${r}",\n    \ttoken: "${o}",\n\t\t\taction: ${a},\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.cK,l),null)},signInWithOtp:e=>{let{otp:r,requestId:o,isRedirection:a=!0}=e;const c=[["$platform",`${window.APP_DATA.applicationID}`],["$verifyOtpRequestInput",`${`{\n\t\t\totp: "${r}",\n    \trequest_id: "${o}",\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.j1,c),null).then((e=>{if(e?.errors)throw e?.errors?.[0];const{user_exists:t}=e?.verifyMobileOTP||{};if(t){const e=new URLSearchParams(l.search).get("redirectUrl")||"";window.location.href=window.location.origin+decodeURIComponent(e)}else a&&n({pathname:"/auth/edit-profile",search:l.search});return e}))},signUp:e=>{const n=window.APP_DATA.applicationID,{registerToken:r,firstName:o,lastName:a,gender:l,email:c,phone:{countryCode:u,mobile:m},password:d}=e,p=[["$platform",`${n}`],["$formRegisterRequestInput",`${`{\n\t\t\tgender: "${l}",\n\t\t\tfirst_name: "${o}",\n\t\t\tlast_name: "${a}",\n\t\t\tpassword: "${d}",\n\t\t\tregister_token: "${r}",\n\t\t\t${c?`email: "${c}",`:""}\n\t\t\t${u&&m?`phone: { country_code: "${u}", mobile: "${m}" },`:""}\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.IJ,p),null)},setPassword:e=>{let{password:r,code:o}=e;const a=[["$code",`${o}`],["$password",`${r}`]];return t.executeGraphQL((0,i.Ll)(s.s_,a),null).then((e=>{if(e?.errors)throw e?.errors?.[0];return n({pathname:"/"}),e}))},sendOtpMobile:e=>{},sendResetPasswordEmail:e=>{const n=window.APP_DATA.applicationID,{email:r}=e,o=[["$platform",`${n}`],["$email",`${r}`]];return t.executeGraphQL((0,i.Ll)(s.C1,o),null)},sendResetPasswordMobile:e=>{},resendVerifyMobileOtp:e=>{const{mobile:n,countryCode:r,token:o}=e,a=[["$platform",`${window.APP_DATA.applicationID}`],["$sendMobileOtpRequestInput",`${`{\n\t\t\tmobile: "${n}",\n\t\t\tcountry_code: "${r}",\n    \ttoken: "${o}",\n\t\t\taction: resend,\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.cK,a),null)},resendVerifyEmailOtp:e=>{const{email:n,registerToken:r,token:o}=e,a=[["$platform",`${window.APP_DATA.applicationID}`],["$sendEmailOtpRequestInput",`${`{\n\t\t\temail: "${n}",\n\t\t\tregister_token: "${r}",\n    \ttoken: "${o}",\n\t\t\taction: resend,\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.QF,a),null)},verifyMobileOtp:e=>{const{requestId:r="",registerToken:o="",otp:a,isEmailVerified:c,isRedirection:u}=e,m=[["$platform",`${window.APP_DATA.applicationID}`],["$verifyOtpRequestInput",`${`{\n\t\t\totp: "${a}",\n\t\t\tregister_token: "${o}",\n    \trequest_id: "${r}",\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.j1,m),null).then((e=>{if(e?.errors)throw e?.errors?.[0];const{user_exists:t,email:r,verify_email_link:o}=e?.verifyMobileOTP||{};if(t)if(o){if(u){const e=new URLSearchParams(l.search);e.set("email",r),n({pathname:"/auth/verify-email-link",search:e.toString()})}}else if(u){const e=new URLSearchParams(l.search).get("redirectUrl")||"";window.location.href=window.location.origin+decodeURIComponent(e)}return e}))},verifyEmailOtp:e=>{const{otp:n,email:r,registerToken:o,action:a,isMobileVerified:c,isRedirection:u}=e,m=[["$platform",`${window.APP_DATA.applicationID}`],["$verifyEmailOtpRequestInput",`${`{\n\t\t\tregister_token: "${o}",\n\t\t\totp: "${n}",\n    \temail: "${r}",\n\t\t\taction: "${a}"\n\t\t}`}`]];return t.executeGraphQL((0,i.Ll)(s.$d,m),null).then((e=>{if(e?.errors)throw e?.errors?.[0];if(u){const e=new URLSearchParams(l.search).get("redirectUrl")||"";window.location.href=window.location.origin+decodeURIComponent(e)}return e}))},sendVerificationLinkEmail:e=>{},facebook:(0,r.useMemo)((()=>({display_text:_,login:facebookLogin}))),addEmail:e=>{}}}},6111:(e,t,n)=>{n.d(t,{Ll:()=>updateGraphQueryWithValue});function updateGraphQueryWithValue(e,t){return e&&t&&Array.isArray(t)?(t.forEach((t=>{const[n,r]=t;n&&r?e=e.split(n).join(r):console.error("Invalid replacement format. Each replacement should be an array [$search, replaceWith].")})),e):(console.error("Invalid input. Please provide a valid main string and an array of replacements."),e)}},1948:(e,t,n)=>{n.d(t,{$d:()=>m,C1:()=>l,IJ:()=>c,QF:()=>d,T_:()=>i,ab:()=>s,cK:()=>u,j1:()=>o,oW:()=>a,s_:()=>p,xc:()=>r});const r='mutation LoginWithOTP {\n  loginWithOTP(platform: "$platform", sendOtpRequestSchemaInput: $sendOtpRequestInput) {\n    country_code\n    email\n    message\n    mobile\n    register_token\n    request_id\n    resend_email_token\n    resend_timer\n    resend_token\n    success\n    user_exists\n    verify_email_otp\n    verify_mobile_otp\n  }\n}',o='mutation VerifyMobileOTP {\n  verifyMobileOTP(platform: "$platform", verifyOtpRequestSchemaInput: $verifyOtpRequestInput) {\n    register_token\n    user {\n      id\n      account_type\n      active\n      application_id\n      created_at\n      dob\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      first_name\n      gender\n      last_name\n      meta\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n      profile_pic_url\n      updated_at\n      user_id\n      username\n      debug {\n        platform\n        source\n      }\n      has_old_password_hash\n      uid\n    }\n    user_exists\n  }\n}',a='mutation LoginWithEmailAndPassword {\n    loginWithEmailAndPassword(passwordLoginRequestSchemaInput: {\n        username: "$username",\n        password: "$password",\n      }) {\n      register_token\n      request_id\n      user {\n        id\n        account_type\n        active\n        application_id\n        created_at\n        dob\n        emails {\n          active\n          email\n          primary\n          verified\n        }\n        first_name\n        gender\n        last_name\n        meta\n        phone_numbers {\n          active\n          country_code\n          phone\n          primary\n          verified\n        }\n        profile_pic_url\n        updated_at\n        user_id\n        username\n        debug {\n          platform\n          source\n        }\n        has_old_password_hash\n        uid\n      }\n    }\n  }',i="query Logout {\n  user {\n    logout {\n      logout\n    }\n  }\n}",s='mutation UpdateProfile {\n  updateProfile(platform: "$platform", editProfileRequestSchemaInput: $editProfileRequestInput) {\n    country_code\n    email\n    message\n    mobile\n    register_token\n    request_id\n    resend_email_token\n    resend_timer\n    resend_token\n    success\n    user {\n      id\n      account_type\n      active\n      application_id\n      created_at\n      dob\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      first_name\n      gender\n      last_name\n      meta\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n      profile_pic_url\n      updated_at\n      user_id\n      username\n      debug {\n        platform\n        source\n      }\n      has_old_password_hash\n      uid\n    }\n    user_exists\n    verify_email_link\n    verify_email_otp\n    verify_mobile_otp\n  }\n}',l='mutation SendResetPasswordEmail {\n  sendResetPasswordEmail(platform: "$platform", sendResetPasswordEmailRequestSchemaInput: {email: "$email"}) {\n    status\n  }\n}',c='mutation RegisterWithForm {\n  registerWithForm(platform: "$platform", formRegisterRequestSchemaInput: $formRegisterRequestInput) {\n    country_code\n    email\n    message\n    mobile\n    register_token\n    request_id\n    resend_email_token\n    resend_timer\n    resend_token\n    success\n    user_exists\n    verify_email_otp\n    verify_mobile_otp\n  }\n}\n',u='mutation SendOTPOnMobile {\n  sendOTPOnMobile(sendMobileOtpRequestSchemaInput: $sendMobileOtpRequestInput, platform: "$platform") {\n    country_code\n    message\n    mobile\n    register_token\n    request_id\n    resend_timer\n    resend_token\n    success\n  }\n}\n',m='mutation VerifyEmailOTP {\n  verifyEmailOTP(platform: "$platform", verifyEmailOtpRequestSchemaInput: $verifyEmailOtpRequestInput) {\n    register_token\n    user {\n      id\n      account_type\n      active\n      application_id\n      created_at\n      dob\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      first_name\n      gender\n      last_name\n      meta\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n      profile_pic_url\n      updated_at\n      user_id\n      username\n      debug {\n        platform\n        source\n      }\n      has_old_password_hash\n      uid\n    }\n    user_exists\n  }\n}',d='mutation SendOTPOnEmail {\n  sendOTPOnEmail(platform: "$platform", sendEmailOtpRequestSchemaInput: $sendEmailOtpRequestInput) {\n    success\n  }\n}',p='mutation ForgotPassword {\n  forgotPassword(forgotPasswordRequestSchemaInput: { code: "$code", password: "$password" }) {\n    register_token\n    request_id\n    user {\n      id\n      account_type\n      active\n      application_id\n      created_at\n      dob\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      first_name\n      gender\n      last_name\n      meta\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n      profile_pic_url\n      updated_at\n      user_id\n      username\n      debug {\n        platform\n        source\n      }\n      has_old_password_hash\n      uid\n    }\n  }\n}'},447:t=>{t.exports=e},9155:e=>{e.exports=t},1862:e=>{e.exports=n},4442:e=>{e.exports=r}},a={};function __webpack_require__(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return o[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{__webpack_require__.r(i),__webpack_require__.d(i,{default:()=>f});var e=__webpack_require__(9155),t=__webpack_require__.n(e),n=__webpack_require__(1862),r="verify-both__formWrapper___Nb6_V",o="verify-both__header___S2G3x",a="verify-both__inputGroup___a6crA",s="verify-both__label___HB1x4",l="verify-both__loginAlert___MRZ38",c="verify-both__otpSentMessage___gTv_z",u="verify-both__resendOtpBtn___cB7j8",m="verify-both__resendOtpWrapper___cAYFq",d="verify-both__submitBtn___QNkyp",p="verify-both__verifyOtpForm___GEfa9",_=__webpack_require__(345);function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(null,arguments)}const f=function VerifyBoth(i){let{fpi:f,isShowVerifyMobile:h=!0,isShowVerifyEmail:g=!0,verifyBothData:b={}}=i;const w=(0,n.useForm)({defaultValues:{otp:""}}),$=(0,e.useId)(),[y,v]=(0,e.useState)(!1),[P,k]=(0,e.useState)(!1),[O,E]=(0,e.useState)(30),I=(0,e.useRef)(null),R=(0,n.useForm)({defaultValues:{otp:""}}),S=(0,e.useId)(),[q,L]=(0,e.useState)(!1),[T,x]=(0,e.useState)(!1),[A,M]=(0,e.useState)(90),D=(0,e.useRef)(null),{isLoggedIn:N,verifyMobileOtp:U,resendVerifyMobileOtp:G,verifyEmailOtp:V,resendVerifyEmailOtp:C}=(0,_.o)({fpi:f}),Q=(0,e.useMemo)((()=>!!h&&!y),[h,y]),j=(0,e.useMemo)((()=>!!g&&!q),[g,q]),mobileTimer=e=>{I.current&&clearInterval(I.current),E(e),k(!1),I.current=setInterval((()=>{E((e=>e<=1?(clearInterval(I.current),k(!0),0):e-1))}),1e3)},emailTimer=e=>{D.current&&clearInterval(D.current),M(e),x(!1),D.current=setInterval((()=>{M((e=>e<=1?(clearInterval(D.current),x(!0),0):e-1))}),1e3)};return(0,e.useEffect)((()=>(mobileTimer(b?.resend_timer||30),emailTimer(90),()=>{clearInterval(I.current),clearInterval(D.current)})),[]),t().createElement("div",{className:"verify-both__verifyBoth___kvwA5"},Q&&t().createElement("div",{className:r},t().createElement("h3",{className:o},"Verify Mobile"),t().createElement("form",{className:p,onSubmit:w.handleSubmit((e=>{if(!e.otp)return;const t={requestId:b?.request_id,registerToken:b?.register_token,otp:e.otp,isEmailVerified:!1,isRedirection:!0};U(t).then((()=>{v(!0)})).catch((e=>{v(!1),w.setError("root",{message:e?.message||"Something went wrong"})}))}))},t().createElement("div",null,t().createElement("p",{className:c},`OTP sent to ${b?.mobile}`),t().createElement("div",{className:a},t().createElement("label",{className:s,htmlFor:$},"Enter OTP"),t().createElement("input",_extends({id:$,type:"number",maxLength:4},w.register("otp",{validate:e=>/^[0-9]{4}$/.test(e)}))))),w.formState.errors.root&&t().createElement("div",{className:l},t().createElement("span",null,w.formState.errors.root.message)),t().createElement("button",{className:d,type:"submit",disabled:!w.formState.isValid},"Submit"),t().createElement("div",{className:m},t().createElement("button",{className:u,onClick:e=>{e.stopPropagation(),e.preventDefault();const t={mobile:b.mobile,countryCode:b.country_code,token:b.resend_token};G(t).then((e=>{if(e?.errors)throw e?.errors?.[0];const t=e.SendOTPOnMobile;k(!1),E(t?.resend_timer||30),mobileTimer(t?.resend_timer||30)})).catch((e=>{v(!1),w.setError("root",{message:e?.message||"Something went wrong"})}))},disabled:!P},"Resend OTP",!P&&` (${O}S)`)))),j&&t().createElement("div",{className:r},t().createElement("h3",{className:o},"Verify Email"),t().createElement("form",{className:p,onSubmit:R.handleSubmit((e=>{if(!e.otp)return;V({otp:e?.otp,email:b?.email,registerToken:b?.register_token,action:N?"verify":"register",isRedirection:!0}).then((()=>{L(!0)})).catch((e=>{L(!1),R.setError("root",{message:e?.message||"Something went wrong"})}))}))},t().createElement("div",null,t().createElement("p",{className:c},`OTP sent to ${b?.email}`),t().createElement("div",{className:a},t().createElement("label",{className:s,htmlFor:S},"Enter OTP"),t().createElement("input",_extends({id:S,type:"number",maxLength:4},R.register("otp",{validate:e=>/^[0-9]{4}$/.test(e)}))))),R.formState.errors.root&&t().createElement("div",{className:l},t().createElement("span",null,R.formState.errors.root.message)),t().createElement("button",{className:d,type:"submit",disabled:!R.formState.isValid},t().createElement("span",null,"Submit")),t().createElement("div",{className:m},t().createElement("button",{className:u,onClick:e=>{e.stopPropagation(),e.preventDefault();const t={email:b.email,registerToken:b.register_token,token:b.resend_email_token};C(t).then((e=>{if(e?.errors)throw e?.errors?.[0];x(!1),M(90),emailTimer(90)})).catch((e=>{R.setError("root",{message:e?.message||"Something went wrong"})}))},disabled:!T},"Resend OTP",!T&&` (${A}S)`)))))}})(),i})()));